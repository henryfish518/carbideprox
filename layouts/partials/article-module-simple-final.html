<!-- 最终简化版文章模块 -->
{{ $title := .title | default "文章列表" }}
{{ $category := .category | default "" }}
{{ $limit := .limit | default 8 }}
{{ $viewAllLink := .viewAllLink | default "#" }}
{{ $site := .Site }}

<!-- 定义分类映射：英文名到中文名 -->
{{ $categoryMap := dict "yyjs" "电商运营技术" "zbrj" "电商直播软件" "dqrj" "店群软件" "cprj" "多多出评软件" }}
{{ $categoryName := index $categoryMap $category | default $category }}

<!-- 直接使用 where 筛选文章，不使用条件判断 -->
{{ $pages := where $site.RegularPages "Params.categories" "intersect" (slice $categoryName) }}

<section class="article-module">
    <div class="container">
        <div class="module-header">
            <h2 class="module-title">{{ $title }}</h2>
            <a href="{{ $viewAllLink }}" class="view-all">查看全部 <i class="fas fa-arrow-right"></i></a>
        </div>
        
        <div class="articles-grid">
            {{ if gt (len $pages) 0 }}
                {{ range first $limit ($pages.ByDate.Reverse) }}
                <article class="article-card">
                    {{ $coverImage := partial "get-cover-image-local.html" . }}
                    <div class="article-image">
                        <img src="{{ $coverImage }}" alt="{{ .Title }}" loading="lazy">
                    </div>
                    
                    <div class="article-content">
                        <div class="article-meta">
                            {{ if .Params.tags }}
                            <span class="article-tag">{{ index .Params.tags 0 }}</span>
                            {{ end }}
                        </div>
                        
                        <h3 class="article-title">
                            <a href="{{ .Permalink }}">{{ .Title }}</a>
                        </h3>
                        
                        <p class="article-excerpt">
                            {{ .Summary | plainify | truncate 60 }}
                        </p>
                        
                        <div class="article-footer">
                            <span class="article-date" data-date="{{ .Date.Format "01-02" }}">{{ .Date.Format "01-02" }}</span>
                            <a href="{{ .Permalink }}" class="read-more">
                                <i class="fas fa-arrow-right"></i> 更多
                            </a>
                        </div>
                    </div>
                </article>
                {{ end }}
            {{ else }}
                <div class="no-articles">暂无相关文章</div>
            {{ end }}
        </div>
    </div>
</section>